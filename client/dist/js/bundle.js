!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s="./client/src/bundles/bundle.js")}({"./client/src/bundles/bundle.js":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(1),a=r(o),l=n("./client/src/components/ElementList.js"),i=r(l),u=n("./client/src/components/Element.js"),s=r(u),d=n("./client/src/components/ColumnSize.js"),c=r(d);window.document.addEventListener("DOMContentLoaded",function(){a.default.component.registerMany({ElementList:i.default,Element:s.default,ColumnSize:c.default},{force:!0})})},"./client/src/components/ColumnSize.js":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{actions:{reduxForm:(0,p.bindActionCreators)({autofill:g.autofill},e)}}}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(3),d=r(s),c=n(0),f=r(c),p=n(4),m=n(6),g=n(11),h=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n.handleChangeSize=n.handleChangeSize.bind(n),n.handleChangeOffset=n.handleChangeOffset.bind(n),n}return l(t,e),u(t,[{key:"getColSizeSource",value:function(){for(var e=[],t=1;t<=this.props.gridColumns;t++)e.push({label:"Column "+t+"/"+this.props.gridColumns,value:t});return e}},{key:"getOffsetSizeSource",value:function(){var e=[];e.push({label:"None",value:0});for(var t=1;t<=this.props.gridColumns;t++)e.push({label:"Column "+t+"/"+this.props.gridColumns,value:t});return e}},{key:"handleClick",value:function(e){e.stopPropagation()}},{key:"handleChangeSize",value:function(e){var t=this.props,n=t.elementId,r=t.defaultViewport;this.props.actions.reduxForm.autofill("element.ElementForm_"+n,"PageElements_"+n+"_Size"+r,e.target.value),this.props.handleChangeSize(e)}},{key:"handleChangeOffset",value:function(e){var t=this.props,n=t.elementId,r=t.defaultViewport;this.props.actions.reduxForm.autofill("element.ElementForm_"+n,"PageElements_"+n+"_Offset"+r,e.target.value),this.props.handleChangeOffset(e)}},{key:"render",value:function(){var e=[];e.push({label:"None",value:0});for(var t=1;t<=this.props.gridColumns;t++)e.push({label:"Column "+t+"/"+this.props.gridColumns,value:t});return d.default.createElement("div",null,d.default.createElement("hr",null),d.default.createElement("label",{className:"mb-0 font-italic",htmlFor:"colSize"},"Size ",this.props.defaultViewport,d.default.createElement("select",{defaultValue:this.props.size,onChange:this.handleChangeSize,onClick:this.handleClick,id:"colSize"},this.getColSizeSource().map(function(e){return d.default.createElement("option",{value:e.value},e.label)}))),d.default.createElement("label",{className:"mb-0 ml-2 font-italic",htmlFor:"colOffset"},"Offset ",this.props.defaultViewport,d.default.createElement("select",{defaultValue:this.props.offset,onChange:this.handleChangeOffset,onClick:this.handleClick,id:"colOffset"},this.getOffsetSizeSource().map(function(e){return d.default.createElement("option",{value:e.value},e.label)}))))}}]),t}(s.PureComponent);h.defaultProps={},h.propTypes={actions:f.default.shape({reduxFrom:f.default.object}),elementId:f.default.number,size:f.default.number,defaultViewport:f.default.string,offset:f.default.number,gridColumns:f.default.number,handleChangeSize:f.default.func,handleChangeOffset:f.default.func},t.default=(0,p.compose)((0,m.connect)(function(){},i))(h)},"./client/src/components/Element.js":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){var n=t.element.id,r=(0,T.loadElementFormStateName)(n),o=(0,O.loadElementSchemaValue)("schemaUrl",n),a=function(e){return"Tabs"===e.component},l=e.form&&e.form.formSchemas[o]&&e.form.formSchemas[o].schema&&e.form.formSchemas[o].schema.fields.find(a),i=l&&l.id,u="element."+r+"__"+i;return{tabSetName:i,activeTab:e.tabs&&e.tabs.fields&&e.tabs.fields[u]&&e.tabs.fields[u].activeTab}}function s(e,t){var n=(0,T.loadElementFormStateName)(t.element.id);return{onActivateTab:function(t,r){e(k.activateTab("element."+n+"__"+t,r))}}}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(3),f=r(c),p=n(0),m=r(p),g=n("./client/src/types/elementType.js"),h=n("./client/src/types/elementTypeType.js"),b=n(4),v=n(1),y=n(8),E=r(y),C=n(7),S=r(C),_=n(6),T=n("./client/src/state/editor/loadElementFormStateName.js"),O=n("./client/src/state/editor/loadElementSchemaValue.js"),D=n(12),k=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(D),j=n(5),w=n(9),x=n("./client/src/lib/dragHelpers.js"),I=function(e){function t(e){a(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleKeyUp=n.handleKeyUp.bind(n),n.handleExpand=n.handleExpand.bind(n),n.handleLoadingError=n.handleLoadingError.bind(n),n.handleTabClick=n.handleTabClick.bind(n),n.updateFormTab=n.updateFormTab.bind(n),n.handleChangeSize=n.handleChangeSize.bind(n),n.handleChangeOffset=n.handleChangeOffset.bind(n),n.state={previewExpanded:!1,initialTab:"",loadingError:!1,childRenderingError:!1,size:e.element.blockSchema.grid.column.size,offset:e.element.blockSchema.grid.column.offset},n}return i(t,e),d(t,null,[{key:"getDerivedStateFromError",value:function(){return{childRenderingError:!0}}}]),d(t,[{key:"componentDidMount",value:function(){var e=this.props.connectDragPreview;e&&e((0,w.getEmptyImage)(),{captureDraggingState:!0})}},{key:"getVersionedStateClassName",value:function(){var e=this.props.element;return e.isPublished?e.isPublished&&!e.isLiveVersion?"element-editor__element--modified":"element-editor__element--published":"element-editor__element--draft"}},{key:"getColumnSizeClassNames",value:function(){var e,t=this.props.element;return e={},o(e,"col-lg-"+this.state.size,!0),o(e,"offset-lg-"+this.state.offset,!0),o(e,"is-row",!0===t.blockSchema.grid.isRow),o(e,"is-dragged-top",this.props.isDraggedOver&&"top"===this.props.isDraggedOverPosition),o(e,"is-dragged-bottom",this.props.isDraggedOver&&"bottom"===this.props.isDraggedOverPosition),e}},{key:"handleLoadingError",value:function(){this.setState({loadingError:!0})}},{key:"updateFormTab",value:function(e){var t=this.props,n=t.tabSetName,r=t.onActivateTab,o=this.state.initialTab;o||this.setState({initialTab:e}),e||o?r(n,e||o):r(n,"Main")}},{key:"handleTabClick",value:function(e){var t=this.props.activeTab,n=this.state.loadingError;e===t||n||(this.setState({previewExpanded:!0}),this.updateFormTab(e))}},{key:"handleExpand",value:function(e){var t=this.props,n=t.type,r=t.link,o=this.state.loadingError;return"button"===e.target.type?void e.stopPropagation():n.inlineEditable&&!o?void this.setState({previewExpanded:!this.state.previewExpanded}):void(window.location=r)}},{key:"handleKeyUp",value:function(e){var t=e.target.nodeName;" "!==e.key&&"Enter"!==e.key||["input","textarea"].includes(t.toLowerCase())||this.handleExpand(e)}},{key:"handleChangeSize",value:function(e){this.setState({size:e.target.value})}},{key:"handleChangeOffset",value:function(e){this.setState({offset:e.target.value})}},{key:"render",value:function(){var e=this,t=this.props,n=t.element,r=t.type,o=t.areaId,a=t.HeaderComponent,l=t.ContentComponent,i=t.ColumnSizeComponent,u=t.link,s=t.activeTab,d=t.connectDragSource,c=t.connectDropTarget,p=t.isDragging,m=t.isOver,g=t.onDragEnd,h=this.state,b=h.childRenderingError,v=h.previewExpanded;if(!n.id)return null;var y=E.default.inject(E.default._t("ElementalElement.TITLE","Edit this {type} block"),{type:r.title}),C=(0,S.default)("element-editor__element",{"element-editor__element--expandable":r.inlineEditable,"element-editor__element--expanded":v,"element-editor__element--dragging":p,"element-editor__element--dragged-over":m},this.getVersionedStateClassName(),this.getColumnSizeClassNames()),_=c(f.default.createElement("div",{className:C,onClick:this.handleExpand,onKeyUp:this.handleKeyUp,role:"button",tabIndex:0,title:y,key:n.id},f.default.createElement(a,{element:n,type:r,areaId:o,expandable:r.inlineEditable,link:u,previewExpanded:v&&!b,handleEditTabsClick:this.handleTabClick,activeTab:s,disableTooltip:p,onDragEnd:g}),!b&&f.default.createElement(l,{id:n.id,fileUrl:n.blockSchema.fileURL,fileTitle:n.blockSchema.fileTitle,content:n.blockSchema.content,previewExpanded:v&&!p,activeTab:s,onFormInit:function(){return e.updateFormTab(s)},handleLoadingError:this.handleLoadingError}),b&&f.default.createElement("div",{className:"alert alert-danger mt-2"},E.default._t("ElementalElement.CHILD_RENDERING_ERROR","Something went wrong with this block. Please try saving and refreshing the CMS.")),!n.blockSchema.grid.isRow&&f.default.createElement(i,{elementId:n.id,size:n.blockSchema.grid.column.size,defaultViewport:n.blockSchema.grid.column.defaultViewport,gridColumns:n.blockSchema.grid.gridColumns,offset:n.blockSchema.grid.column.offset,handleChangeSize:this.handleChangeSize,handleChangeOffset:this.handleChangeOffset})));return p?_:v?_:d(_)}}]),t}(c.Component);I.propTypes={element:g.elementType,type:h.elementTypeType.isRequired,areaId:m.default.number.isRequired,link:m.default.string.isRequired,activeTab:m.default.string,tabSetName:m.default.string,onActivateTab:m.default.func,connectDragSource:m.default.func.isRequired,connectDragPreview:m.default.func.isRequired,connectDropTarget:m.default.func.isRequired,isDragging:m.default.bool.isRequired,isOver:m.default.bool.isRequired,onDragOver:m.default.func,onDragEnd:m.default.func,onDragStart:m.default.func,isDraggedOver:m.default.bool,isDraggedOverPosition:m.default.string},I.defaultProps={element:null},t.Component=I;var P={drop:function(e,t,n){var r=e.element;return{target:r.id,dropSpot:(0,x.isOverTop)(t,n,r)?"top":"bottom"}},hover:function(e,t,n){var r=e.element,o=e.onDragOver;o&&o(r,(0,x.isOverTop)(t,n,r))}};t.default=(0,b.compose)((0,j.DropTarget)("element",P,function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}}),(0,j.DragSource)("element",x.elementDragSource,function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}}),(0,_.connect)(u,s),(0,v.inject)(["ElementHeader","ElementContent","ColumnSize"],function(e,t,n){return{HeaderComponent:e,ContentComponent:t,ColumnSizeComponent:n}},function(){return"ElementEditor.ElementList.Element"}))(I)},"./client/src/components/ElementList.js":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(3),d=r(s),c=n(0),f=r(c),p=n("./client/src/types/elementType.js"),m=n("./client/src/types/elementTypeType.js"),g=n(4),h=n(1),b=n(7),v=r(b),y=n(8),E=r(y),C=n(5),S=n("./client/src/lib/dragHelpers.js"),_=n("./client/src/state/editor/elementConfig.js"),T=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),u(t,[{key:"getDragIndicatorIndex",value:function(){var e=this.props,t=e.dragTargetElementId,n=e.draggedItem,r=e.blocks,o=e.dragSpot;return(0,S.getDragIndicatorIndex)(r.map(function(e){return e.id}),t,n&&n.id,o)}},{key:"renderBlocks",value:function(){var e=this,t=this.props,n=t.ElementComponent,r=t.HoverBarComponent,o=t.blocks,a=t.allowedElementTypes,l=t.elementTypes,i=t.areaId,u=t.onDragEnd,s=t.onDragOver,c=t.onDragStart,f=t.isDraggingOver;if(!o)return null;if(o&&!o.length)return d.default.createElement("div",null,E.default._t("ElementList.ADD_BLOCKS","Add blocks to place your content"));var p=o.map(function(t){return d.default.createElement(n,{key:t.id,element:t,areaId:i,type:(0,_.getElementTypeConfig)(t.blockSchema.typeName,l),link:t.blockSchema.actions.edit,onDragOver:s,onDragEnd:u,onDragStart:c,isDraggedOver:e.props.dragTargetElementId===t.id&&e.props.draggedItem&&e.props.draggedItem.id!==t.id,isDraggedOverPosition:e.props.dragSpot},f||d.default.createElement(r,{key:"create-after-"+t.id,areaId:i,elementId:t.id,elementTypes:a}))});return f||(p=[d.default.createElement(r,{key:0,areaId:i,elementId:0,elementTypes:a})].concat(p)),p}},{key:"renderLoading",value:function(){var e=this.props,t=e.loading,n=e.LoadingComponent;return t?d.default.createElement(n,null):null}},{key:"render",value:function(){var e=this.props.blocks,t=(0,v.default)("elemental-editor-list","row",{"elemental-editor-list--empty":!e||!e.length});return this.props.connectDropTarget(d.default.createElement("div",{className:t},this.renderLoading(),this.renderBlocks()))}}]),t}(s.Component);T.propTypes={blocks:f.default.arrayOf(p.elementType),elementTypes:f.default.arrayOf(m.elementTypeType).isRequired,allowedElementTypes:f.default.arrayOf(m.elementTypeType).isRequired,loading:f.default.bool,areaId:f.default.number.isRequired,dragTargetElementId:f.default.oneOfType([f.default.string,f.default.bool]),onDragOver:f.default.func,onDragStart:f.default.func,onDragEnd:f.default.func},T.defaultProps={blocks:[],loading:!1},t.Component=T;var O={drop:function(e,t){var n=e.blocks,r=t.getDropResult();if(!r)return{};var o=(0,S.getDragIndicatorIndex)(n.map(function(e){return e.id}),r.target,t.getItem(),r.dropSpot),a=n[o-1]?n[o-1].id:"0";return i({},r,{dropAfterID:a})}};t.default=(0,g.compose)((0,C.DropTarget)("element",O,function(e,t){return{connectDropTarget:e.dropTarget(),draggedItem:t.getItem()}}),(0,h.inject)(["Element","Loading","HoverBar","DragPositionIndicator"],function(e,t,n,r){return{ElementComponent:e,LoadingComponent:t,HoverBarComponent:n,DragIndicatorComponent:r}},function(){return"ElementEditor.ElementList"}))(T)},"./client/src/lib/dragHelpers.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elementDragSource=t.getDragIndicatorIndex=t.isOverTop=void 0;var r=n(10);t.isOverTop=function(e,t){var n=e.getClientOffset(),o=(0,r.findDOMNode)(t).getBoundingClientRect();return!0===t.props.element.blockSchema.grid.isRow?n.y<o.y+o.height/2:n.x<o.x+o.width/2},t.getDragIndicatorIndex=function(e,t,n,r){if(null===t||!n)return null;var o=t?e.findIndex(function(e){return e===t}):0,a=e.findIndex(function(e){return e===n});return"bottom"===r&&(o+=1),a===o||a+1===o?null:o},t.elementDragSource={beginDrag:function(e){return e.element},endDrag:function(e,t){var n=e.onDragEnd,r=t.getDropResult();if(n&&r&&r.dropAfterID){var o=t.getItem().id,a=r.dropAfterID;o!==a&&n(o,a)}}}},"./client/src/state/editor/elementConfig.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElementTypeConfig=t.getConfig=void 0;var r=n(2),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=t.getConfig=function(){return o.default.getSection("DNADesign\\Elemental\\Controllers\\ElementalAreaController")};t.getElementTypeConfig=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(Array.isArray(t)?t:a().elementTypes).find(function(t){return t.class===e||t.name===e})}},"./client/src/state/editor/loadElementFormStateName.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadElementFormStateName=void 0;var r=n(2),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.loadElementFormStateName=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=o.default.getSection("DNADesign\\Elemental\\Controllers\\ElementalAreaController"),n=t.form.elementForm.formNameTemplate;return e?n.replace("{id}",e):n}},"./client/src/state/editor/loadElementSchemaValue.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadElementSchemaValue=void 0;var r=n(2),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.loadElementSchemaValue=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=o.default.getSection("DNADesign\\Elemental\\Controllers\\ElementalAreaController"),r=n.form.elementForm[e]||"";return t?r+"/"+t:r}},"./client/src/types/elementType.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elementType=void 0;var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=o.default.shape({id:o.default.string.isRequired,title:o.default.string,blockSchema:o.default.object,inlineEditable:o.default.bool,published:o.default.bool,liveVersion:o.default.bool,version:o.default.number});t.elementType=a},"./client/src/types/elementTypeType.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elementTypeType=void 0;var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),a=o.default.shape({name:o.default.string,title:o.default.string,icon:o.default.string,inlineEditable:o.default.boolean,editTabs:o.default.arrayOf(o.default.shape({title:o.default.string,name:o.default.string})),config:o.default.object});t.elementTypeType=a},0:function(e,t){e.exports=PropTypes},1:function(e,t){e.exports=Injector},10:function(e,t){e.exports=ReactDom},11:function(e,t){e.exports=ReduxForm},12:function(e,t){e.exports=TabsActions},2:function(e,t){e.exports=Config},3:function(e,t){e.exports=React},4:function(e,t){e.exports=Redux},5:function(e,t){e.exports=ReactDND},6:function(e,t){e.exports=ReactRedux},7:function(e,t){e.exports=classnames},8:function(e,t){e.exports=i18n},9:function(e,t){e.exports=ReactDNDHtml5Backend}});